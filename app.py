import streamlit as st

# æ¨™é¡Œèˆ‡èªªæ˜
st.title("ç´«å¾®ã„‹ã„Ÿã„‹ã„Ÿè¨ˆç®—å™¨")

st.markdown("""
### ä½¿ç”¨èªªæ˜ ğŸ’â€â™€ï¸ ç´«å¾®ã„‹ã„Ÿã„‹ã„Ÿåœ¨ç·šé–‹æ›ï¼

ä½ ä»¥ç‚ºå‘½ç›¤åªèƒ½ç®—æµå¹´ï¼ŸNONONOï½  
å¾å‘½ç›¤ä¹Ÿæ˜¯å¯ä»¥ç ´è§£å‘½å®®è£¡çš„ç½©æ¯å¯†ç¢¼å–” ğŸ”®ğŸ‘™  

æ“ä½œæ–¹æ³•è¶…ç°¡å–®ï¼š
1. è«‹æ‰“é–‹ä½ çš„ç´«å¾®å‘½ç›¤ï¼ŒèªçœŸç«¯è©³ã€Œå‘½å®®ã€é·ç§»å®®ã€çˆ¶æ¯å®®ã€ç–¾å„å®®ã€é€™å››å€‹é‡é»å®®ä½æœ‰ä»€éº¼æ˜Ÿæ›œé–ƒé–ƒç™¼äº® âœ¨  
2. æ¥è‘—ä¾ç…§é€™äº›å®®ä½è£¡çš„**ä¸»æ˜Ÿ**ã€**æ¡ƒèŠ±æ˜Ÿ**ï¼ˆè¶Šå¤šè¶Šè±æ»¿ï¼‰ã€ä»¥åŠ**ç…å¿Œæ˜Ÿ**ï¼ˆæœƒç¸®æ°´çš„é‚£ç¨®ï¼‰ï¼Œé€ä¸€å‹¾é¸  
3. ã„‹ã„Ÿã„‹ã„Ÿæœƒå¹«ä½ ç®—å‡ºä¸€å€‹é©šäººä½†æº–ç¢ºï¼ˆï¼Ÿï¼‰çš„æ•¸å€¼ï¼Œå†å°ç…§ç´«å¾®ç•Œç¥•å‚³ç½©æ¯è¡¨ï¼Œé æ¸¬ä½ çš„ç½©æ¯å¤§å°ï½  

> ğŸ‘™ æœ¬å·¥å…·ç‚ºå¨›æ¨‚ç”¨é€”ï¼Œç”±ã€Œ**å¤§æ‚…è€å¸«**ã€åŸå‰µç™¼æƒ³  
> ğŸ“º å‡ºè™•ï¼š [YouTube å½±ç‰‡é€£çµ](https://www.youtube.com/watch?v=-s7LXSS6wKo&list=PLJL36iDIoC2w3DEZKelNPzdt4D2-pRsZ-&index=1)  
> ğŸ‘µ *ç´«å¾®ã„‹ã„Ÿã„‹ã„Ÿè²¼å¿ƒå®åš€ï¼šæº–äº†ä¸è¦å¤ªé©šè¨ï¼Œæ²’ä¸­ä¹Ÿåˆ¥ææˆ‘å˜¿ï½*
""")

# ===== ä¸»æ˜Ÿå€ =====
main_stars = {
    "å¤ªé™½": 4,
    "è²ªç‹¼": 4,
    "å¤©åŒ": 3,
    "å¤©åºœ": 3,
    "ç ´è»": 3,
    "ç´«å¾®": 3,
    "å¤ªé™°": 3,
    "å»‰è²": 3,
    "å¤©æ©Ÿ": 2,
    "ä¸ƒæ®º": 2,
    "å¤©æ¢": 2,
    "æ­¦æ›²": 2,
}

st.header("1ï¸âƒ£ è«‹å°‡é€™äº›å®®ä½ä¸­æœ‰çš„ä¸»æ˜Ÿå‹¾é¸èµ·ä¾†")
selected_main_stars = st.multiselect("ä¸»æ˜Ÿ", list(main_stars.keys()))

# ===== æ¡ƒèŠ±æ˜Ÿï¼ˆåŠ åˆ†ï¼‰=====
bonus_stars = ["é¾æ± ", "é³³é–£", "å¤©å§š", "æ–‡æ›²", "ç´…é¸", "å¤©å–œ"]

st.header("2ï¸âƒ£ è«‹å°‡é€™äº›å®®ä½ä¸­æœ‰çš„æ¡ƒèŠ±æ˜Ÿå‹¾é¸èµ·ä¾†ï¼ˆæ¯å€‹+1ï¼‰")
selected_bonus = st.multiselect("æ¡ƒèŠ±æ˜Ÿ", bonus_stars)

# ===== ç…å¿Œæ˜Ÿï¼ˆæ‰£åˆ†ï¼‰=====
penalty_stars = ["æ“ç¾Š", "é™€ç¾…", "éˆ´æ˜Ÿ", "ç«æ˜Ÿ", "åŒ–å¿Œ"]

st.header("3ï¸âƒ£ è«‹å°‡é€™äº›å®®ä½ä¸­æœ‰çš„ç…å¿Œæ˜Ÿå‹¾é¸èµ·ä¾†ï¼ˆæ¯å€‹-1ï¼‰")
selected_penalty = st.multiselect("ç…å¿Œæ˜Ÿï¼ˆä¸å«åŒ–å¿Œï¼‰", penalty_stars[:-1])
huaji_count = st.number_input("åŒ–å¿Œå‡ºç¾å¹¾æ¬¡ï¼Ÿ", min_value=0, step=1)

# ===== è¨ˆç®—èˆ‡çµæœ =====
if st.button("âœ¨ è¨ˆç®—çµæœ"):
    # ä¸»æ˜Ÿå¹³å‡å€¼
    if selected_main_stars:
        main_avg = sum([main_stars[star] for star in selected_main_stars]) / len(selected_main_stars)
    else:
        main_avg = 0

    # åŠ åˆ†èˆ‡æ‰£åˆ†æ•¸é‡
    bonus = len(selected_bonus)
    penalty = len(selected_penalty) + huaji_count

    # æœ€çµ‚åˆ†æ•¸
    total_score = round(main_avg + bonus - penalty)

    # ç½©æ¯å°æ‡‰è¡¨èˆ‡èªéŒ„
    cup_map = {
        1: ("Aç½©æ¯", "ä½ å‘½æ ¼æ¸…æ–°è„«ä¿—ï¼Œä½èª¿ä¸­è‡ªå¸¶éˆæ°£ï¼Œå°å¿ƒè¢«å…§è¡Œäººä¸€çœ¼ç›¸ä¸­ï½"),
        2: ("Bç½©æ¯", "ä¸å¼µæšä½†ç©©ç•¶ï¼Œé©åˆæ…¢ç†±å‹æˆ€æ„›ï¼Œèµ°åˆ°å“ªéƒ½æœ‰å¾®å…‰ç’°ç¹ä½ ï½"),
        3: ("Cç½©æ¯", "å‰›å‰›å¥½æ˜¯æœ€å¥½çš„å®‰æ’ï¼Œæ¡ƒèŠ±ä¸å¤šä¸å°‘ï¼Œè²´äººé©æ™‚å‡ºç¾ï½"),
        4: ("Dç½©æ¯", "é­…åŠ›é€æ¼¸è§£é–ä¸­ï¼Œå§»ç·£é–‹å§‹å‹•èµ·ä¾†ï¼Œå‡ºé–€åˆ¥å¿˜äº†å¸¶ç¬‘å®¹ï½"),
        5: ("Eç½©æ¯", "å“å‘€ï½ä½ çœŸæ˜¯è‡ªå¸¶æˆ€æ„›é«”è³ªï¼Œèµ°é€²å“ªè£¡éƒ½åƒæ‹å¶åƒåŠ‡ï¼"),
        6: ("Fç½©æ¯", "å§»ç·£çŠ¯è¦ç´šåˆ¥ï¼Œæ¡ƒèŠ±å¤šåˆ°å¥¶å¥¶ä¹Ÿçœ‹ä¸å®Œï¼Œå°å¿ƒæ¡ƒèŠ±å‚µå–”ï½"),
    }

    final_result, comment = cup_map.get(total_score, ("è¶…å‡ºç¯„åœ ğŸ˜µ", "é€™å‘½æ ¼è¶…å‡ºå¥¶å¥¶èƒ½é æ¸¬çš„ç¯„åœï¼Œè«‹ä½èª¿è¡Œäº‹..."))

    # é¡¯ç¤ºçµæœ
    st.subheader("ğŸ’¡ è¨ˆç®—çµæœ")
    st.write(f"ä¸»æ˜Ÿå¹³å‡å€¼ï¼š{main_avg:.2f}")
    st.write(f"åŠ åˆ†ï¼š+{bonus}ï¼Œæ‰£åˆ†ï¼š-{penalty}")
    st.write(f"æœ€çµ‚æ•¸å€¼ï¼š{total_score}")
    st.success(f"ğŸ§™â€â™€ï¸ ç´«å¾®å¥¶å¥¶é æ¸¬çµæœï¼š**{final_result}**\n\nğŸ’¬ **å¥¶å¥¶é–‹ç¤ºï¼š** {comment}")
